---
title: "Missing Case Report Form Fields Report"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  html_document:
    theme: paper
    highlight: tango
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
      side: left
    toc_depth: 3
    number_sections: false
  word_document:
    toc: true
    toc_depth: '3'
---

```{css, echo = FALSE}
h3 {
  text-align: center;
  font-weight: bold;
}
```

```{r setup, echo = FALSE, warning = FALSE}
opts_chunk$set(echo = TRUE)
```

<h3 style="text-align:center; font-weight:bold;">Visit Summaries</h3>
<br>

Participant and visit summary information for a particular case report form (CRF) can be included in these reports. Simply customize the code blocks to include report-relevant information. Examples are provided.

<h4 style="text-align:center;">Visit Counts by Participant</h4>

See how many visits have been completed for all participants, including those who failed screening.

Lengthy table outputs can be converted to an optional dropdown menu.

```{r CountSummary, echo = FALSE}
# enable toggle dropdown output
asis_output("
<details>
<summary>Show Table</summary>
")

edc %>%
  group_by(pid) %>%
  summarise(
    `Visit Count` = n()
    #`Percent` = round(100 * n() / nrow(edc), 1)
  ) %>%
  rename(
    `Participant ID` = pid
  ) %>%
  kable(align = "c") %>%
  kable_styling(full_width = FALSE, position = "center")

# enable toggle dropdown output
asis_output("</details>")
```

<h4 style="text-align:center;">Cumulative Visit Counts</h4>

```{r EventSummary, echo = FALSE}
edc %>%
  group_by(visit_type) %>%
  summarise(
    Count = n(),
    Percent = round(100 * n() / nrow(edc), 1)
  ) %>%
  rename(Visit = visit_type) %>%
  kable(align = "c") %>%
  kable_styling(full_width = FALSE, position = "center")
```

<h4 style="text-align:center;">Baseline Procedure Completion</h4>

```{r BaselineProcedures, echo = FALSE}
edc %>%
  summarise(
    Complete = sum(baseline_procedures_inst_complete == 1, na.rm = TRUE),
    Incomplete = sum(baseline_procedures_inst_complete == 0, na.rm = TRUE)
  ) %>%
  kable(align = "c") %>%
  kable_styling(full_width = FALSE, position = "center")
```

<h3 style="text-align:center; font-weight:bold;">Missing CRF Fields</h3>
<br>

<h4 style="text-align:center;">Screening Instrument</h4>

```{r MissingScreening, echo = FALSE}
screening_missing %>%
  rename(
    `Participant ID` = pid,
    `Missing Fields` = missing_fields
  ) %>%
  kable(align = "c") %>%
  kable_styling(full_width = FALSE, position = "center")
```

<h4 style="text-align:center;">Health History Instrument</h4>

```{r MissingHealth, echo = FALSE}
health_missing %>%
  rename(
    `Participant ID` = pid,
    `Missing Fields` = missing_fields
  ) %>%
  kable(align = "c") %>%
  kable_styling(full_width = FALSE, position = "center")
```

<h4 style="text-align:center;">Baseline Procedures Instrument</h4>

```{r MissingProcedures, echo = FALSE}
v1_procedures_missing %>%
  rename(
    `Participant ID` = pid,
    `Missing Fields` = missing_fields
  ) %>%
  kable(align = "c") %>%
  kable_styling(full_width = FALSE, position = "center")
```

<h4 style="text-align:center;">Lab Results Instrument</h4>

```{r MissingLabResults, echo = FALSE}
v1_labresults_missing %>%
  rename(
    `Participant ID` = pid,
    `Missing Fields` = missing_fields
  ) %>%
  kable(align = "c") %>%
  kable_styling(full_width = FALSE, position = "center")
```
